(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{359:function(t,a,s){"use strict";s.r(a);var n=s(25),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"bestdori-自制谱作图器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bestdori-自制谱作图器"}},[t._v("#")]),t._v(" Bestdori 自制谱作图器")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("这个插件必须要求 酷Q Pro 版本，因为要发送图片")])]),t._v(" "),s("h2",{attrs:{id:"部署流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署流程"}},[t._v("#")]),t._v(" 部署流程")]),t._v(" "),s("h3",{attrs:{id:"解压"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解压"}},[t._v("#")]),t._v(" 解压")]),t._v(" "),s("p",[t._v("将 "),s("a",{attrs:{href:"https://github.com/fz6m/nonebot-plugin/releases/download/0.11/BestdoriMake.zip",target:"_blank",rel:"noopener noreferrer"}},[t._v("本插件"),s("OutboundLink")],1),t._v(" 下载解压，将解压得到的 "),s("code",[t._v("CQBangbang")]),t._v(" 文件夹放在 酷Q 根目录下，为了保证路径不出错误，还要检查如下事项："),s("br"),t._v("\n保证你的 NoneBot 主程序 "),s("code",[t._v("main.py(这里假设为main.py)")]),t._v(" 和 "),s("code",[t._v("bangbang")]),t._v(" 以及 "),s("code",[t._v("bangbang_data")]),t._v(" 两个文件夹在同一级目录，文件夹 "),s("code",[t._v("CQBangbang")]),t._v(" 里已经包含了一个示例主程序 "),s("code",[t._v("main.py")]),t._v(" 可供参考，如果你还有其他插件，你可以直接把 "),s("code",[t._v("main.py")]),t._v(" 中有关导入本插件的部分拷贝进你的主程序 "),s("code",[t._v("_.py")]),t._v(" 文件。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#导入本插件")]),t._v("\n    nonebot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load_plugins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__file__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bangbang'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bangbang'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"安装依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装依赖"}},[t._v("#")]),t._v(" 安装依赖")]),t._v(" "),s("p",[t._v("本插件还依赖处理图片的 python 库，需要安装以下依赖：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("    pip "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" requests\n    pip "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" pillow\n    pip "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" ujson\n    pip "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" msgpack\n")])])]),s("p",[t._v("注：如果安装 "),s("code",[t._v("ujson")]),t._v(" 依赖失败，你可以在 "),s("a",{attrs:{href:"https://www.lfd.uci.edu/~gohlke/pythonlibs/#ujson",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),s("OutboundLink")],1),t._v(" 下载对应你 "),s("code",[t._v("python")]),t._v(" 版本和位数的 "),s("code",[t._v("ujson")]),t._v(" 安装包，之后执行本地安装即可：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("    pip "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" 本地 ujson 安装包"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(".whl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("路径\n")])])]),s("h3",{attrs:{id:"配置屏蔽群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置屏蔽群"}},[t._v("#")]),t._v(" 配置屏蔽群")]),t._v(" "),s("p",[t._v("为了不打扰非 邦邦 相关群，可以配置屏蔽群号列表，在屏蔽列表内的群不能使用相关指令，如果你不打算配置屏蔽群，可以跳过此步。"),s("br"),t._v("\n配置文件在 "),s("code",[t._v("bangbang_data/qunShield.txt")]),t._v(" ，需要屏蔽的群号按行写入，示例：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("    1234567\n    9876543\n")])])]),s("h3",{attrs:{id:"配置推送群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置推送群"}},[t._v("#")]),t._v(" 配置推送群")]),t._v(" "),s("p",[t._v("本插件可以自动推送 "),s("code",[t._v("Bestdori")]),t._v(" 社区最新上传的谱面信息，并推送到所有配置的群内，如果你不打算使用推送功能，可以跳过此步。"),s("br"),t._v("\n配置文件在 "),s("code",[t._v("bangbang_data/send.txt")]),t._v(" ，需要推送的群号按行写入，示例：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("    1234567\n    9876543\n")])])]),s("h3",{attrs:{id:"开始使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开始使用"}},[t._v("#")]),t._v(" 开始使用")]),t._v(" "),s("p",[t._v("群内发送如下格式指令可以得到相应的反馈，下文还会给出相关使用示例：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("    指令名 id/关键词\n    .指令名id/关键词\n")])])]),s("p",[t._v("目前支持的指令：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("指令")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("ssp")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("按关键词搜索相关谱面，默认显示最新的 10 张")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("kkp")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("按 id 查询该谱面的基本信息（歌曲名、Level、时长、作者）")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("search")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("按 id 查询该谱面的详细信息（封面、歌曲名、歌手、Level、时长、作者、上传时间、介绍）")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("map")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("按 id 作出谱面图片")])])])]),t._v(" "),s("p",[t._v("注：为了使用指令更加简便， "),s("code",[t._v("ssp")]),t._v(" 指令还可以缩写成 "),s("code",[t._v("s")]),t._v("、"),s("code",[t._v("sp")]),t._v(" 。 "),s("code",[t._v("kkp")]),t._v(" 可缩写成 "),s("code",[t._v("k")]),t._v("、"),s("code",[t._v("kp")]),t._v(" 。 "),s("code",[t._v("search")]),t._v(" 可错写成 "),s("code",[t._v("serch")]),t._v(" 。下文还会介绍如何删改相关指令。 "),s("br"),s("br"),t._v("\n例子：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("    // 查询名字包含 鸡你太美 的谱面\n    s 鸡你太美\n    sp 鸡你太美\n    .s鸡你太美\n    .ssp鸡你太美\n\n    // 查询标签包含 Arcaea 的谱面\n    s #Arcaea\n\n    // 查询标签包含 鸡头 名字包含 鸡 的谱面\n    s #鸡头 鸡\n\n    // 查询 id 为 7070 的谱面基本信息\n    k 7070\n    kkp 7070\n    .k7070\n\n    // 查询 id 为 7070 的谱面详细信息\n    search 7070\n\n    // 查看 id 为 7070 的谱面图片\n    map 7070\n")])])]),s("h2",{attrs:{id:"增删改指令名"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#增删改指令名"}},[t._v("#")]),t._v(" 增删改指令名")]),t._v(" "),s("p",[t._v("如果你想删改相关指令，可以在 "),s("code",[t._v("bangbang/__init__.py")]),t._v(" 文件内找到如下部分：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("    ···\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# base info")]),t._v("\n    baseKeyList "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'k'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'kp'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'kkp'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    code "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reasonable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("baseKeyList"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    ···\n")])])]),s("p",[t._v("每一个功能的可用指令都是用列表封装的，如果你想增删改查询谱面 基本信息 的相关指令，在 "),s("code",[t._v("baseKeyList")]),t._v(" 变量内修改即可，其他功能修改指令方法相同。")]),t._v(" "),s("h2",{attrs:{id:"修改谱面图质量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改谱面图质量"}},[t._v("#")]),t._v(" 修改谱面图质量")]),t._v(" "),s("p",[t._v("因为 酷Q 能发送图片最大的大小和你的网络情况有关，一般图片超过 10 s 还未被上传成功的话，发送就会失败，也就是说，假如你的服务器带宽只有 1 M ，那么你的图片最大只能发送 1 M 左右，所以必须要对谱面图片做出压缩限制，本插件默认配置就可以满足 1 M 带宽的服务器使用，无需更改。"),s("br"),t._v("\n如果你拥有更高的带宽，可以进行如下更改提升你的谱面图质量，在 "),s("code",[t._v("bangbang/mapGet.py")]),t._v(" 中前几行，你可以找到如下部分：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("    ···\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mapGet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("bot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("qun"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        comRatio "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n    ···\n")])])]),s("p",[t._v("其中 "),s("code",[t._v("comRatio")]),t._v(" 即为图片压缩比例，对于 1 M 带宽的网络，我们推荐设置为 3 ，如果你想提升图片质量，可调整至 2 或 1 ， 2 即为压缩一倍， 1 即为不压缩，但是设定为 1 时图片会大出几倍，导致上传失败，请谨慎使用。"),s("br"),t._v("\n另外，图片的压缩还有一个模糊参数，这个功能是 "),s("code",[t._v("PIL")]),t._v(" 库自带的压缩可选项，你可以在 "),s("code",[t._v("bangbang/mapGet.py")]),t._v(" 尾部找到如下部分：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#存图片")]),t._v("\n    backgroundPlus"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("resize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("plusWidth"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("marginPlus"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("comRatio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("plusHeight"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("marginPlus"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("comRatio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("convert"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'RGB'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    save"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("imageP"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("quality"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n")])])]),s("p",[t._v("其中，参数 "),s("code",[t._v("quality")]),t._v(" 后的值即为模糊比，最大设定为 100 （不模糊压缩），数值越小模糊程度越大，相对应的图片就越大。但是不建议修改此参数，因为图片清晰度的主要原因在于 "),s("code",[t._v("comRatio")]),t._v(" 设定的压缩比，这也是没有单独抽取此参数的原因。")]),t._v(" "),s("h2",{attrs:{id:"单独作出高质量的谱面图"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#单独作出高质量的谱面图"}},[t._v("#")]),t._v(" 单独作出高质量的谱面图")]),t._v(" "),s("p",[t._v("有些时候你可能需要很高质量、清晰的谱面图，在 "),s("code",[t._v("bangbang/HighQualityImage.py")]),t._v(" 内准备了解决方案，可以让你本地手动运行获得高质量的谱面图。"),s("br"),t._v("\n在使用前，你需要配置好该文件内的 作图参数 ，以下是该文件的配置部分：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 核心参数 设定以下四个即可")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 谱面 id")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7070")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 压缩参数-压缩百分比 | 高质量图可以设定为 1(不压缩)或2(压缩一倍)")]),t._v("\n    comRatio "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 音轨剪断节数 | 一般 2-4 min 歌曲设定为 8-12 若歌曲特别短")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如 1 min 可设定为更小值 不建议小于 5 ")]),t._v("\n    cutNumber "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 压缩参数-画面质量 | 一般设定为 50-100")]),t._v("\n    imageQuality "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n")])])]),s("p",[t._v("另外，使用前也必须安装相关的依赖和确保静态资源文件没有被移动位置，在该 "),s("code",[t._v("HighQualityImage.py")]),t._v(" 内均有详细说明，配置好后手动运行即可得到高质量的谱面图。")])])}),[],!1,null,null,null);a.default=e.exports}}]);